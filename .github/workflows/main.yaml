name: 
on:
  push:
    branches:
      - main
env:
  ghSha: ${{ github.sha }}
  ghToken: ${{ secrets.GITHUB_TOKEN }}

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repo
        uses: actions/checkout@v2
        with:
          fetch-depth: 1
      - name: get tree-sitter cli
        run: | 
            make getTreeSitter 
      - name: generate
        run: |
            echo "TERM=xterm" >> $GITHUB_ENV
            bin/tree-sitter generate
            printf %60s | tr ' ' '-' && echo
            echo 'checks:  parse error will abort run'   
            printf %60s | tr ' ' '-' && echo
      - name: 2.5 Types
        run: bin/tree-sitter parse examples/types.xq
      - name: 3.1 Primary Expressions
        run: bin/tree-sitter parse examples/primary_expressions.xq 
      - name: 3.2 Postfix Expressions
        run: bin/tree-sitter parse examples/postfix_expressions.xq 
      - name: 3.3 Path Expressions
        run: bin/tree-sitter parse examples/path_expressions.xq 
      - name: 3.4 Sequence Expressions
        run: bin/tree-sitter parse examples/sequence_expressions.xq 
      - name: 3.5 Arithmetic Expressions
        run: bin/tree-sitter parse examples/arithmetic_expressions.xq 
      - name: 3.5 Arithmetic Expressions
        run: bin/tree-sitter parse examples/arithmetic_expressions.xq 
      - name: 3.6 String Concatenation Expressions
        run: bin/tree-sitter parse examples/string_concatenation_expressions.xq 
      - name: 3.7 Comparison Expressions
        run: bin/tree-sitter parse examples/comparison_expressions.xq 
      - name: 3.8 Logical Expressions
        run: bin/tree-sitter parse examples/logical_expressions.xq 
      - name: 3.9 Node Constructors
        run: bin/tree-sitter parse examples/node_constructors.xq 
      - name: 3.10 String Constructors
        run: bin/tree-sitter parse examples/string_constructors.xq 
      - name: 3.11 Maps and Arrays 
        run: bin/tree-sitter parse examples/maps_and_arrays.xq 
      - name: 3.12 FLWOR Expressions 
        run: bin/tree-sitter parse examples/FLWOR_expressions.xq 
      - name: 3.13 Ordered and Unordered Expressions
        run: bin/tree-sitter parse examples/ordered_and_unordered_expressions.xq 
      - name: 3.14 Conditional Expressions
        run: bin/tree-sitter parse examples/conditional_expressions.xq 
      - name: 3.15 Switch Expression
        run: bin/tree-sitter parse examples/switch_expression.xq 
      - name: 3.16 Quantified Expressions
        run: bin/tree-sitter parse examples/quantified_expressions.xq 
      - name: 3.17 Try Catch Expressions
        run: bin/tree-sitter parse examples/try_catch_expressions.xq 
      - name: 3.18 Expressions on SequenceTypes 
        run: bin/tree-sitter parse examples/expressions_on_sequence_types.xq 
      - name: 3.19 Simple map operator 
        run: bin/tree-sitter parse examples/bang.xq 
      - name: 3.19 Simple map operator 
        run: bin/tree-sitter parse examples/bang.xq 
      - name: 3.20 Arrow operator (=>)
        run: bin/tree-sitter parse examples/arrow.xq 
      - name: 4.1 Version Declaration
        run: bin/tree-sitter parse examples/version_declaration.xq 
      - name: 4.2 Module Declaration
        run: bin/tree-sitter parse examples/module_declaration.xq 
      - name: 4.3 Boundary-space Declaration
        run: bin/tree-sitter parse examples/boundary_space_declaration.xq 
      - name: 4.4 Default Collation Declaration
        run: bin/tree-sitter parse examples/default_collation_declaration.xq 
      - name: 4.5 Base URI Declaration 
        run: bin/tree-sitter parse examples/base_URI_declaration.xq 
      - name: 4.6 Construction Declaration
        run: bin/tree-sitter parse examples/construction_declaration.xq 
      - name: 4.7 Ordering Mode Declaration
        run: bin/tree-sitter parse examples/ordering_mode_declaration.xq 
      - name: 4.8 Empty Order Declaration 
        run: bin/tree-sitter parse examples/empty_order_declaration.xq 
      - name: 4.9 Copy-Namespaces Declaration
        run: bin/tree-sitter parse examples/copy_namespaces_declaration.xq 
      - name: 4.10 Decimal Format Declaration 
        run: bin/tree-sitter parse examples/decimal_format_declaration.xq 
      - name: 4.11 Schema Import
        run: bin/tree-sitter parse examples/schema_import.xq 
      - name: 4.12 Module Import
        run: bin/tree-sitter parse examples/module_import.xq 
      - name: 4.13 Namespace Declaration
        run: bin/tree-sitter parse examples/namespace_declaration.xq 
      - name: 4.14 Default Namespace Declaration
        run: bin/tree-sitter parse examples/default_namespace_declaration.xq 
      - name: 4.15 Annotations 
        run: bin/tree-sitter parse examples/annotations.xq 
      - name: 4.16 Variable Declaration
        run: bin/tree-sitter parse examples/variable_declaration.xq 
      - name: 4.17 Context Item Declaration
        run: bin/tree-sitter parse examples/context_item_declaration.xq 
      - name: 4.18 Function Declaration
        run: bin/tree-sitter parse examples/function_declaration.xq 
      - name: 4.19 Option Declaration
        run: bin/tree-sitter parse examples/option_declaration.xq 
      - name: Comments
        run: bin/tree-sitter parse examples/comments.xq 
      - name: highlight queries
        run: bin/tree-sitter query --captures queries/highlights.scm examples/app/use_case_JSON.xq
      - name: tests - 4 Modules and Prologs
        run: test TEST_SECTION="4."
      - name: TEST Primary Expressions - 3.1.1 Literal
        run: test TEST_SECTION="3.1.1 Literal"
